// Define todos los ramos con sus relaciones
const ramos = [
  // Primer año - Semestre I
  { nombre: "Taller de desarrollo socio-personal", requisitos: [] },
  { nombre: "Fundamentos del Trabajo Social", requisitos: [], abre: ["Teoría y método del Trabajo Social"] },
  { nombre: "Procesos psicosociales I", requisitos: [] },
  { nombre: "Antropología sociocultural", requisitos: [] },
  { nombre: "Historia social contemporánea", requisitos: [] },
  { nombre: "Fundamentos epistemológicos de las ciencias sociales", requisitos: [], abre: ["Teorías sociales"] },

  // Primer año - Semestre II
  { nombre: "Taller de habilidades profesionales", requisitos: [], abre: ["Taller de aproximación a la realidad social"] },
  { nombre: "Estadística social", requisitos: [], abre: ["Metodología de investigación social I"] },
  { nombre: "Procesos psicosociales II", requisitos: [] },
  { nombre: "Ética profesional del Trabajo Social", requisitos: [] },
  { nombre: "Estado y Sociedad", requisitos: [] },
  { nombre: "Teorías sociales", requisitos: ["Fundamentos epistemológicos de las ciencias sociales"], abre: ["Epistemología del Trabajo Social", "Metodología de investigación social II", "Políticas públicas"] },

  // Segundo año - Semestre I
  { nombre: "Teoría y método del Trabajo Social", requisitos: ["Fundamentos del Trabajo Social"], abre: ["Teoría y método del Trabajo Social II"] },
  { nombre: "Taller de aproximación a la realidad social", requisitos: ["Taller de habilidades profesionales"], abre: ["Taller de pedagogía social"] },
  { nombre: "Metodología de investigación social I", requisitos: ["Estadística social"], abre: ["Metodología de investigación social II", "Taller integrado de investigación social"] },
  { nombre: "Economía Social", requisitos: [], abre: ["Estructura social y desigualdad social"] },
  { nombre: "Epistemología del Trabajo Social", requisitos: ["Teorías sociales"] },

  // Segundo año - Semestre II
  { nombre: "Teoría y método del Trabajo Social II", requisitos: ["Teoría y método del Trabajo Social"], abre: ["Intervención social"] },
  { nombre: "Estructura social y desigualdad social", requisitos: ["Economía Social"], abre: ["Redes sociales e intersectorialidad"] },
  { nombre: "Metodología de investigación social II", requisitos: ["Teorías sociales", "Metodología de investigación social I"], abre: ["Taller integrado de investigación social"] },
  { nombre: "Contextos jurídicos para la intervención social", requisitos: [] },
  { nombre: "Taller de pedagogía social", requisitos: ["Taller de aproximación a la realidad social"] },

  // Tercer año - Semestre I
  { nombre: "Intervención social", requisitos: ["Teoría y método del Trabajo Social II"], abre: ["Análisis de la cuestión social"] },
  { nombre: "Planificación social", requisitos: [], abre: ["Políticas sociales y gestión social"] },
  { nombre: "Redes sociales e intersectorialidad", requisitos: ["Estructura social y desigualdad social"] },
  { nombre: "Interculturalidad y colectivos sociales", requisitos: [] },
  { nombre: "Políticas públicas", requisitos: ["Teorías sociales"], abre: ["Políticas sociales y gestión social"] },
  { nombre: "Practica Integrada", requisitos: ["Teoría y método del Trabajo Social II", "Intervención social", "Redes sociales e intersectorialidad", "Políticas públicas", "Taller de pedagogía social", "Estructura social y desigualdad social", "Epistemología del Trabajo Social", "Metodología de investigación social II", "Contextos jurídicos para la intervención social", "Planificación social", "Interculturalidad y colectivos sociales", "Taller integrado de investigación social", "Análisis de la cuestión social"] },

  // Tercer año - Semestre II
  { nombre: "Taller integrado de investigación social", requisitos: ["Metodología de investigación social I", "Metodología de investigación social II"], abre: ["Proyectos Sociales"] },
  { nombre: "Práctica integrada II", requisitos: ["Practica Integrada"] },
  { nombre: "Geografía social", requisitos: [] },
  { nombre: "Políticas sociales y gestión social", requisitos: ["Planificación social", "Políticas públicas"], abre: ["Cambio social y organización social"] },
  { nombre: "Análisis de la cuestión social", requisitos: ["Intervención social"] },
  { nombre: "Derechos humanos", requisitos: [] },

  // Cuarto año - Semestre I
  { nombre: "Cambio social y organización social", requisitos: ["Políticas sociales y gestión social"], abre: ["Electivo de análisis regional II"] },
  { nombre: "Electivo de análisis regional I", requisitos: [], abre: ["Electivo de análisis regional II"] },
  { nombre: "Seminario de investigación social I", requisitos: ["Cambio social y organización social", "Proyectos Sociales", "Desafíos de la actuación profesional de Trabajo Social", "Electivo de análisis regional I"] },
  { nombre: "Proyectos Sociales", requisitos: ["Taller integrado de investigación social"], abre: ["Proyectos sociales II", "Electivo de análisis regional II"] },
  { nombre: "Desafíos de la actuación profesional de Trabajo Social", requisitos: [], abre: ["Electivo de análisis regional II"] },

  // Cuarto año - Semestre II
  { nombre: "Electivo de análisis regional II", requisitos: ["Cambio social y organización social", "Electivo de análisis regional I", "Proyectos Sociales", "Seminario de investigación social I", "Desafíos de la actuación profesional de Trabajo Social"], abre: ["Taller de título I", "Práctica profesional I"] },
  { nombre: "Proyectos sociales II", requisitos: ["Proyectos Sociales"], abre: ["Taller de título I", "Práctica profesional I"] },
  { nombre: "Seminario de investigación social II", requisitos: [], abre: ["Taller de título I", "Práctica profesional I"] },
  { nombre: "Trabajo Social y mundo laboral", requisitos: [], abre: ["Taller de título I", "Práctica profesional I"] },

  // Quinto año
  { nombre: "Taller de título I", requisitos: ["Electivo de análisis regional II", "Proyectos sociales II", "Seminario de investigación social II", "Trabajo Social y mundo laboral"], abre: ["Taller de título II", "Práctica profesional II"] },
  { nombre: "Práctica profesional I", requisitos: ["Electivo de análisis regional II", "Proyectos sociales II", "Seminario de investigación social II", "Trabajo Social y mundo laboral"], abre: ["Taller de título II", "Práctica profesional II"] },
  { nombre: "Taller de título II", requisitos: ["Taller de título I", "Práctica profesional I"] },
  { nombre: "Práctica profesional II", requisitos: ["Taller de título I", "Práctica profesional I"] }
];

// Crear botones
const container = document.getElementById("malla-container");
const botones = {};

ramos.forEach(ramo => {
  const btn = document.createElement("button");
  btn.textContent = ramo.nombre;
  btn.className = "ramo locked";
  botones[ramo.nombre] = btn;
  container.appendChild(btn);

  btn.addEventListener("click", () => {
    if (!btn.classList.contains("locked")) {
      btn.classList.add("approved");
      desbloquear(ramo);
    }
  });
});

function desbloquear(ramo) {
  ramos.forEach(r => {
    if (r.requisitos && r.requisitos.includes(ramo.nombre)) {
      const requisitosCumplidos = r.requisitos.every(req => botones[req].classList.contains("approved"));
      if (requisitosCumplidos) {
        botones[r.nombre].classList.remove("locked");
      }
    }
  });
}

// Inicialmente desbloquea los que no tienen requisitos
ramos.forEach(r => {
  if (!r.requisitos || r.requisitos.length === 0) {
    botones[r.nombre].classList.remove("locked");
  }
});
